# wireshark 面试题

## 两台主机不同子网掩码能否ping通

1. 说明
   1. 服务器A
      * ip: `192.168.26.129`
      * 子网掩码: `255.255.255.0`
      * 默认网关: `192.168.26.2`
   2. 服务器B
      * ip: `192.168.26.3`
      * 子网掩码: `255.255.255.224`
      * 默认网关: `192.168.26.2`
   3. 解答
      *  在服务器B上面ping 服务器A是能够ping通的
      * 服务器B通过ARP广播包查询默认网关: `192.168.26.2`的MAC地址
        * B根据子网掩码匹配原则，查询到A属于不同的子网
        * 网关回复网关ip地址
      * B服务器，发出ping包，指定目的ip为A，但是目的MAC为网关MAC
      * B收到了A发出的ARP广播，这个广播用于查询B的MAC地址，因为在A看来，B属于相同的子网，同一个子网通信无需默认网关的参与，只需要通过ARP获得对方的MAC地址就好了。
        * 这也表明网关把数据包转发给了A
        * B主机回复了A主机的ARP广播包，说明回复ARP时不考虑是不是子网
      * 之后B回复了A的ping回复

## 基本技巧

1. 只抓包头
   * 一般每个数据帧的大小最大长度为1514字节，启用巨型帧之后可以达到9000字节
     * 一般情况下，我们只需要IP头或者TCP头就可以分析了，可以限制每个包的大小，
       * Catture -> option : Limit each packet to 
       * 80
     * tcpdump -s参数： 每个包的大小
       * `-w`: 写入文件
2. 条件过滤表达式
   * `host 1.1.1.1`: 开启抓包是设置
   * `tcpdump -i eth0 host 1.1.1.1`
     * ping
       * `ping -l 1 -n 1`
       * `ping -s 1 -c 1`
3. 抓包时更加复杂的表达式
   * `ip.addr eq 1.1.1.1 && tcp.poert eq 445`